<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>子正博客</title><link>https://Abner1995.github.io</link><description>子正博客</description><copyright>子正博客</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://avatars.githubusercontent.com/u/15809315?v=4</url><title>avatar</title><link>https://Abner1995.github.io</link></image><lastBuildDate>Sat, 31 Aug 2024 02:41:22 +0000</lastBuildDate><managingEditor>子正博客</managingEditor><ttl>60</ttl><webMaster>子正博客</webMaster><item><title>如何利用dotnet maui CollectionView实现聊天页面</title><link>https://Abner1995.github.io/post/ru-he-li-yong-dotnet%20maui%20CollectionView-shi-xian-liao-tian-ye-mian.html</link><description>**MessageDetailPage.xaml**&#13;
`&lt;?xml version='1.0' encoding='utf-8' ?&gt;&#13;
&lt;ContentPage&#13;
    x:Class='ContactSMS.Client.Views.MessageDetailPage'&#13;
    xmlns='http://schemas.microsoft.com/dotnet/2021/maui'&#13;
    xmlns:x='http://schemas.microsoft.com/winfx/2009/xaml'&#13;
    xmlns:model='clr-namespace:ContactSMS.Client.Models'&#13;
    xmlns:templates='clr-namespace:ContactSMS.Client.Views.Templates'&#13;
    xmlns:vm='clr-namespace:ContactSMS.Client.ViewModels'&#13;
    Title='消息详情'&#13;
    x:DataType='vm:MessageViewModel'&gt;&#13;
&#13;
    &lt;ContentPage.Resources&gt;&#13;
        &lt;ResourceDictionary&gt;&#13;
&#13;
            &lt;DataTemplate x:Key='ReceiverChatMessageItemTemplate' x:DataType='model:MessageDetailModel'&gt;&#13;
                &lt;templates:ReceiverChatMessageItemTemplate /&gt;&#13;
            &lt;/DataTemplate&gt;&#13;
&#13;
            &lt;DataTemplate x:Key='SenderChatMessageItemTemplate' x:DataType='model:MessageDetailModel'&gt;&#13;
                &lt;templates:SenderChatMessageItemTemplate /&gt;&#13;
            &lt;/DataTemplate&gt;&#13;
&#13;
            &lt;templates:MessageDataTemplateSelector&#13;
                x:Key='MessageDataTemplateSelector'&#13;
                ReceiverMessageTemplate='{StaticResource ReceiverChatMessageItemTemplate}'&#13;
                SenderMessageTemplate='{StaticResource SenderChatMessageItemTemplate}' /&gt;&#13;
&#13;
            &lt;Style x:Key='ChatCollectionStyle' TargetType='CollectionView'&gt;&#13;
                &lt;Setter Property='Margin' Value='20' /&gt;&#13;
            &lt;/Style&gt;&#13;
        &lt;/ResourceDictionary&gt;&#13;
    &lt;/ContentPage.Resources&gt;&#13;
&#13;
&#13;
    &lt;ScrollView&gt;&#13;
&#13;
        &lt;CollectionView&#13;
            ItemTemplate='{StaticResource MessageDataTemplateSelector}'&#13;
            ItemsSource='{Binding Messages}'&#13;
            Style='{StaticResource ChatCollectionStyle}' /&gt;&#13;
&#13;
    &lt;/ScrollView&gt;&#13;
&#13;
&#13;
&lt;/ContentPage&gt;`&#13;
&#13;
**SenderChatMessageItemTemplate**&#13;
&#13;
`&lt;?xml version='1.0' encoding='utf-8' ?&gt;&#13;
&lt;ContentView&#13;
    x:Class='ContactSMS.Client.Views.Templates.SenderChatMessageItemTemplate'&#13;
    xmlns='http://schemas.microsoft.com/dotnet/2021/maui'&#13;
    xmlns:x='http://schemas.microsoft.com/winfx/2009/xaml'&#13;
    xmlns:model='clr-namespace:ContactSMS.Client.Models'&#13;
    x:DataType='model:MessageDetailModel'&gt;&#13;
&#13;
    &lt;ContentView.Resources&gt;&#13;
        &lt;ResourceDictionary&gt;&#13;
            &lt;Style x:Key='SenderContainerStyle' TargetType='Grid'&gt;&#13;
                &lt;Setter Property='HorizontalOptions' Value='End' /&gt;&#13;
                &lt;Setter Property='Margin' Value='0,15' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Style x:Key='MessageTextStyle' TargetType='Label'&gt;&#13;
                &lt;Setter Property='FontSize' Value='14' /&gt;&#13;
                &lt;Setter Property='TextColor' Value='Black' /&gt;&#13;
                &lt;Setter Property='Padding' Value='10' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Color x:Key='MessageColor'&gt;#D8E9F1&lt;/Color&gt;&#13;
&#13;
            &lt;Style x:Key='MessageShapeStyle' TargetType='BoxView'&gt;&#13;
                &lt;Setter Property='Color' Value='{StaticResource MessageColor}' /&gt;&#13;
                &lt;Setter Property='CornerRadius' Value='24, 0, 24, 24' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Style x:Key='MessageTimeStyle' TargetType='Label'&gt;&#13;
                &lt;Setter Property='TextColor' Value='#A5A4A9' /&gt;&#13;
                &lt;Setter Property='HorizontalOptions' Value='End' /&gt;&#13;
                &lt;Setter Property='Margin' Value='0,5,0,0' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
        &lt;/ResourceDictionary&gt;&#13;
    &lt;/ContentView.Resources&gt;&#13;
&#13;
    &lt;Grid RowDefinitions='*,20' Style='{StaticResource SenderContainerStyle}'&gt;&#13;
        &lt;Grid&gt;&#13;
            &lt;BoxView Style='{StaticResource MessageShapeStyle}' /&gt;&#13;
            &lt;Label Style='{StaticResource MessageTextStyle}' Text='{Binding Content}' /&gt;&#13;
        &lt;/Grid&gt;&#13;
        &lt;Label&#13;
            Grid.Row='1'&#13;
            Style='{StaticResource MessageTimeStyle}'&#13;
            Text='{Binding Date}' /&gt;&#13;
    &lt;/Grid&gt;&#13;
&#13;
&lt;/ContentView&gt;&#13;
`&#13;
&#13;
**ReceiverChatMessageItemTemplate.xaml**&#13;
&#13;
`&lt;?xml version='1.0' encoding='utf-8' ?&gt;&#13;
&lt;ContentView&#13;
    x:Class='ContactSMS.Client.Views.Templates.ReceiverChatMessageItemTemplate'&#13;
    xmlns='http://schemas.microsoft.com/dotnet/2021/maui'&#13;
    xmlns:x='http://schemas.microsoft.com/winfx/2009/xaml'&#13;
    xmlns:model='clr-namespace:ContactSMS.Client.Models'&#13;
    x:DataType='model:MessageDetailModel'&gt;&#13;
&#13;
    &lt;ContentView.Resources&gt;&#13;
        &lt;ResourceDictionary&gt;&#13;
            &lt;Style x:Key='ReceiverContainerStyle' TargetType='Grid'&gt;&#13;
                &lt;Setter Property='HorizontalOptions' Value='Start' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Style x:Key='MessageTextStyle' TargetType='Label'&gt;&#13;
                &lt;Setter Property='FontSize' Value='14' /&gt;&#13;
                &lt;Setter Property='TextColor' Value='Black' /&gt;&#13;
                &lt;Setter Property='Padding' Value='10' /&gt;&#13;
                &lt;Setter Property='Margin' Value='0,0,0,5' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Color x:Key='MessageColor'&gt;#9297A1&lt;/Color&gt;&#13;
&#13;
            &lt;Style x:Key='MessageShapeStyle' TargetType='BoxView'&gt;&#13;
                &lt;Setter Property='Color' Value='{StaticResource MessageColor}' /&gt;&#13;
                &lt;Setter Property='CornerRadius' Value='0, 24, 24, 24' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
            &lt;Style x:Key='MessageTimeStyle' TargetType='Label'&gt;&#13;
                &lt;Setter Property='TextColor' Value='#A5A4A9' /&gt;&#13;
                &lt;Setter Property='HorizontalOptions' Value='Start' /&gt;&#13;
                &lt;Setter Property='Margin' Value='0,5,0,0' /&gt;&#13;
            &lt;/Style&gt;&#13;
&#13;
        &lt;/ResourceDictionary&gt;&#13;
    &lt;/ContentView.Resources&gt;&#13;
&#13;
    &lt;Grid RowDefinitions='*,20' Style='{StaticResource ReceiverContainerStyle}'&gt;&#13;
        &lt;Grid&gt;&#13;
            &lt;BoxView Style='{StaticResource MessageShapeStyle}' /&gt;&#13;
            &lt;Label Style='{StaticResource MessageTextStyle}' Text='{Binding Content}' /&gt;&#13;
        &lt;/Grid&gt;&#13;
        &lt;Label&#13;
            Grid.Row='1'&#13;
            Style='{StaticResource MessageTimeStyle}'&#13;
            Text='{Binding Date}' /&gt;&#13;
    &lt;/Grid&gt;&#13;
&#13;
&lt;/ContentView&gt;&#13;
`&#13;
MessageDataTemplateSelector 必须要是public，&#13;
`using ContactSMS.Client.Models;&#13;
&#13;
namespace ContactSMS.Client.Views.Templates&#13;
{&#13;
    public class MessageDataTemplateSelector : DataTemplateSelector&#13;
    {&#13;
        public DataTemplate SenderMessageTemplate { get; set; }&#13;
        public DataTemplate ReceiverMessageTemplate { get; set; }&#13;
&#13;
        protected override DataTemplate OnSelectTemplate(object item, BindableObject container)&#13;
        {&#13;
            var message = (MessageDetailModel)item;&#13;
&#13;
            if (message.UserId == 0)&#13;
                return ReceiverMessageTemplate;&#13;
&#13;
            return SenderMessageTemplate;&#13;
        }&#13;
    }&#13;
}&#13;
`。</description><guid isPermaLink="true">https://Abner1995.github.io/post/ru-he-li-yong-dotnet%20maui%20CollectionView-shi-xian-liao-tian-ye-mian.html</guid><pubDate>Sat, 31 Aug 2024 02:36:58 +0000</pubDate></item></channel></rss>